<html>
<head>


<script type="text/javascript" src="/static/js/analytics.js"></script>
<script type="text/javascript">archive_analytics.values.server_name="wwwb-app12.us.archive.org";archive_analytics.values.server_ms=138;</script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>


<title>jfbterm for FreeBSD</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="jfbterm for FreeBSD">
<meta name="keywords" content="jfbterm,FreeBSD">
<base href="https://web.archive.org/" />
</head>
<body>




<h1>jfbterm for FreeBSD</h1>

<h2>jfbterm とは</h2>

<p>
KON をベースに作成されたソフトウェアで、Linux のフレームバッファを使用して多言語表示を行うことが出来ます。
</p>

<h2>jfbterm for FreeBSD とは</h2>

<p>
jfbterm バージョン 0.4.7 を FreeBSD に移植したものです。オリジナルにない機能は次のとおりです。
</p>

<ul>
<li>ビープ音を鳴らすことが可能です。
<li>カーソルを点滅させることが可能です。
<li>バックスクロールが可能です。
<li>背景に画像を表示することが可能です。
<li>256 色表示が可能です。
</ul>

<h2>必要なもの</h2>

<p>
jfbterm for FreeBSD を使用するには、VBE 2.0 (VESA BIOS EXTENSION 2.0) に対応したビデオカードが必要です。
また、8bpp, 15bpp, 16bpp, 24bpp, 32bpp のいずれかの色深度に切り替え可能で、リニア・フレームバッファに対応していることが条件になります。
</p>

<h2>jfbterm for FreeBSD を使用するには</h2>

<p>
FreeBSD 6.3-PRERELEASE で、jfbterm for FreeBSD を使用するまでの設定を解説します。
<p>

<h3>VESA フレームバッファのモジュールをロードする</h3>

<p>
次の手順にしたがって VESA フレームバッファのモジュールをロードします。
</p>

<pre>
# kldload vesa
</pre>

<p>
起動時に VESA フレームバッファのモジュールをロードするように、設定ファイルを編集します。
</p>

<p>
/boot/loader.conf に次の一行を追加します。
</p>

<pre>
vesa_load="YES"
</pre>

<h3>jfbterm for FreeBSD をインストールする</h3>

<p>
jfbterm for FreeBSD をインストールするには、libiconv、gmake、pkg-config、autoconf-2.61、automake-1.4 および、png が必要です。
インストールされていない場合は、Ports Collection から、次の Ports をインストールします。
</p>

<ul>
<li>converters/libiconv
<li>devel/gmake
<li>devel/pkg-config
<li>devel/autoconf261
<li>devel/automake14
<li>graphics/png
</ul>

<p>
次の手順にしたがって jfbterm for FreeBSD をインストールしてください。
</p>

<pre>
% fetch http://www.ac.auone-net.jp/~baba/jfbterm/jfbterm-0.4.7-FreeBSD-0.4.0.tar.gz
% tar xvzf jfbterm-0.4.7-FreeBSD-0.4.0.tar.gz
% cd jfbterm-0.4.7-FreeBSD-0.4.0
% ./configure CPPFLAGS=-I/usr/local/include LDFLAGS=-L/usr/local/lib --prefix=/usr/local --mandir=/usr/local/man
% /usr/local/bin/gmake
% su
# /usr/local/bin/gmake install
</pre>

<h3>GNU unifont をインストールする</h3>

<p>
GNU unifont をインストールするには、bdftopcf が必要です。
インストールされていない場合は、Ports Collection から、次の Ports をインストールします。
</p>

<ul>
<li>x11-fonts/bdftopcf
</ul>

<p>
次の手順にしたがって GNU unifont をインストールしてください。
</p>

<pre>
% fetch http://czyborra.com/unifont/hex2bdf
% fetch http://czyborra.com/unifont/unifont.hex.gz
% chmod +x hex2bdf
% gzip -dc unifont.hex.gz | ./hex2bdf | /usr/local/bin/bdftopcf | gzip -9 > unifont.pcf.gz
% su
# cp unifont.pcf.gz /usr/local/lib/X11/fonts/local/unifont.pcf.gz
</pre>

<h3>端末ケーパビリティを追加する</h3>

<p>
jfbterm の端末ケーパビリティを追加します。
</p>

<pre>
# cat /usr/local/share/jfbterm/termcap.jfbterm >> /usr/share/misc/termcap
# cap_mkdb /usr/share/misc/termcap
</pre>

<h3>設定ファイルを用意する</h3>

<p>
設定ファイルのサンプルをコピーします。
</p>

<pre>
# cp /usr/local/etc/jfbterm.conf.sample /usr/local/etc/jfbterm.conf
</pre>

<h2>画面モードを変更するには</h2>

<p>
初期状態では、画面のモードが 1024x768 16bpp に設定されています。ここでは、1024x768 16bpp から 1280x1024 16bpp に変更する方法を解説します。
</p>

<p>
使用できる画面モードを確認します。
</p>

<pre>
% vidcontrol -i mode
    mode#     flags   type    size       font      window      linear buffer
------------------------------------------------------------------------------
　　　　　:
　　　　(中略)
　　　　　:
256 (0x100) 0x0000000f G 640x400x8 1     8x16  0xa0000 64k 64k 0xfe000000 4096k
257 (0x101) 0x0000000f G 640x480x8 1     8x16  0xa0000 64k 64k 0xfe000000 4096k
258 (0x102) 0x0000000b G 800x600x4 4     8x14  0xa0000 64k 64k 0x00000000 4096k
259 (0x103) 0x0000000f G 800x600x8 1     8x16  0xa0000 64k 64k 0xfe000000 4096k
261 (0x105) 0x0000000f G 1024x768x8 1    8x16  0xa0000 64k 64k 0xfe000000 4096k
263 (0x107) 0x0000000f G 1280x1024x8 1   8x16  0xa0000 64k 64k 0xfe000000 4096k
264 (0x108) 0x00000009 T 80x60           8x8   0xb8000 32k 32k 0x00000000 4096k
265 (0x109) 0x00000009 T 132x25          8x16  0xb8000 32k 32k 0x00000000 4096k
267 (0x10b) 0x00000009 T 132x50          8x8   0xb8000 32k 32k 0x00000000 4096k
268 (0x10c) 0x00000009 T 132x60          8x8   0xb8000 32k 32k 0x00000000 4096k
273 (0x111) 0x0000000f G 640x480x16 1    8x16  0xa0000 64k 64k 0xfe000000 4096k
274 (0x112) 0x0000000f G 640x480x32 1    8x16  0xa0000 64k 64k 0xfe000000 4096k
276 (0x114) 0x0000000f G 800x600x16 1    8x16  0xa0000 64k 64k 0xfe000000 4096k
277 (0x115) 0x0000000f G 800x600x32 1    8x16  0xa0000 64k 64k 0xfe000000 4096k
279 (0x117) 0x0000000f G 1024x768x16 1   8x16  0xa0000 64k 64k 0xfe000000 4096k　← 初期値
280 (0x118) 0x0000000f G 1024x768x32 1   8x16  0xa0000 64k 64k 0xfe000000 4096k
282 (0x11a) 0x0000000f G 1280x1024x16 1  8x16  0xa0000 64k 64k 0xfe000000 4096k　← 変更後
284 (0x11c) 0x0000000f G 1600x1200x8 1   8x16  0xa0000 64k 64k 0xfe000000 4096k
286 (0x11e) 0x0000000f G 1600x1200x16 1  8x16  0xa0000 64k 64k 0xfe000000 4096k
</pre>

<p>
設定ファイル /usr/local/etc/jfbterm.conf の video.mode の値を 282 に変更すると、画面のモードが 1280x1024 16bpp に設定されます。
</p>

<pre>
video.mode: 282
</pre>


<h2>カラー表示を止めたいときは</h2>

<p>
初期状態ではカラー表示を行うように設定されています。カラー表示を止めたいときは、環境変数 TERM の値を jfbterm に設定するか、設定ファイル /usr/local/etc/jfbterm.conf の term の値を jfbterm-color から jfbterm に変更してください。
</p>

<pre>
term: jfbterm
</pre>

<h2>Meta キーを使いたいときは</h2>

<p>
キーボードに Windows キーがある場合は、Windows キーに Meta キーを割り当てる方法があります。
ここでは、US104 キーボードを例に解説します。
</p>

<p>
syscons(4) のキー割り当て設定ファイルをコピーします。
</p>

<pre>
# cp /usr/share/syscons/keymaps/us.iso.kbd /usr/share/syscons/keymaps/us.104.kbd
</pre>

/usr/share/syscons/keymaps/us.104.kbd のキーコード 105, 106 の設定を変更します。

<pre>
  105   meta   fkey62 fkey62 fkey62 fkey62 fkey62 fkey62 fkey62  O
  106   meta   fkey63 fkey63 fkey63 fkey63 fkey63 fkey63 fkey63  O
</pre>

/etc/rc.conf の keymap の設定を変更します。

<pre>
keymap="us.104"
</pre>

<h2>表示速度が遅いときは</h2>

<p>
VESA フレームバッファの描画速度が遅いと感じることがありますが、ライトコンバインを設定することによって、描画速度を向上することが出来ます。
</p>

<pre>
% vidcontrol -i adapter
fb0:
    vga0, type:VESA VGA (5), flags:0x700ff
    initial mode:24, current mode:282, BIOS mode:3
    frame buffer window:0xfe000000, buffer size:0x400000
    window size:0x400000, origin:0x0
    display start address (0, 0), scan line width:2560
    reserved:0xfe000000
</pre>

<p>
ライトコンバインを設定する範囲は、frame buffer window から、buffer size を指定します。
</p>

<pre>
# memcontrol set -b 0xfe000000 -l 0x400000 -o vesafb write-combine
</pre>

<h2>ダウンロード</h2>

<a href="/web/20080226043336/http://www.ac.auone-net.jp/~baba/jfbterm/jfbterm-0.4.7-FreeBSD-0.4.0.tar.gz">jfbterm-0.4.7-FreeBSD-0.4.0.tar.gz</a>

<h2>スクリーンショット</h2>

<h3>emacs21+mule-ucs で view-hello-file を実行したところ</h3>
<img src="/web/20080226043336im_/http://www.ac.auone-net.jp/~baba/jfbterm/emacs21-mule-ucs.png">

<h3>256 色表示を行ったところ</h3>
<img src="/web/20080226043336im_/http://www.ac.auone-net.jp/~baba/jfbterm/256color-demo.png">

<h3>端末の背景に画像を表示したところ</h3>
<img src="/web/20080226043336im_/http://www.ac.auone-net.jp/~baba/jfbterm/wallpaper-demo.jpg">


<br><br>
<hr>
<br>
バグの報告やパッチは Yusuke Baba (babayaga1 _at_ y8.dion.ne.jp) まで、お願いします。
<br><br>
</body>
</html>





<!--
     FILE ARCHIVED ON 4:33:36 Feb 26, 2008 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 4:36:25 Nov 26, 2016.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
